(window.webpackJsonp=window.webpackJsonp||[]).push([[62],{1001:function(e,t,i){"use strict";i.r(t);var r=i(0),s=(i(4),i(9),i(5)),n=(i(6),i(1)),a=i(2),o=i(14),l=(i(3),i(10),i(7)),c=(i(11),i(36)),u=i(225),d=i(725),h=i(445);const p=e=>{let t=class extends e{async fetchPopupFeatures(e){const{layer:t}=this;if(!e)return Object(l.h)(new o.a("wmslayerview:fetchPopupFeatures","Nothing to fetch without area",{layer:t}));const{popupEnabled:i}=t;if(!i)return Object(l.h)(new o.a("wmslayerview:fetchPopupFeatures","popupEnabled should be true",{popupEnabled:i}));const r=this.createFetchPopupFeaturesQuery(e),{extent:s,width:n,height:a,x:c,y:u}=r;if(!(s&&n&&a))throw new o.a("wmslayerview:fetchPopupFeatures","WMSLayer does not support fetching features.",{extent:s,width:n,height:a});const d=t.fetchFeatureInfo(s,n,a,c,u);return d?d.then(e=>[e]):Object(l.r)([])}};return Object(r.a)([Object(n.b)()],t.prototype,"layer",void 0),t=Object(r.a)([Object(a.a)("esri.layers.mixins.WMSLayerView")],t),t};var b=i(576),m=i(446),y=i(598);const f=s.a.getLogger("esri.views.2d.layers.WMSLayerView2D");let g=class extends(p(Object(u.a)(Object(m.a)(h.a)))){initialize(){const{layer:e,view:t}=this;e.supportsSpatialReference(t.spatialReference)||this.addResolvingPromise(Object(l.h)(new o.a("layerview:spatial-reference-incompatible","The spatial references supported by this WMS layer are incompatible with the spatial reference of the view",{layer:e})))}hitTest(){return null}update(e){this.strategy.update(e).catch(e=>{Object(l.b)(e)||f.error(e)})}attach(){const{layer:e,view:t}=this,{imageMaxHeight:i,imageMaxWidth:r}=e;this._bitmapContainer=new b.a,this.container.addChild(this._bitmapContainer),this.strategy=new y.a({container:this._bitmapContainer,fetchSource:this.fetchImage.bind(this),requestUpdate:this.requestUpdate.bind(this),imageMaxHeight:i,imageMaxWidth:r,imageRotationSupported:!1,imageNormalizationSupported:!1,hidpi:!1}),this._exportWMSImageParameters=new d.a({layer:e,view:t}),this.handles.add(this._exportWMSImageParameters.watch("version",e=>{this._exportImageVersion!==e&&(this._exportImageVersion=e,this.requestUpdate())}),"wms")}detach(){this.handles.remove("wms"),this.strategy.destroy(),this._exportWMSImageParameters.layer=null,this._exportWMSImageParameters.destroy(),this._exportWMSImageParameters=null,this.container.removeChild(this._bitmapContainer),this._bitmapContainer.removeAllChildren()}moveStart(){}viewChange(){}moveEnd(){this.requestUpdate()}createFetchPopupFeaturesQuery(e){const{view:t}=this,i=this._bitmapContainer,{x:r,y:s}=e,{spatialReference:n}=t;let a=null,o=0,l=0;i.children.some(e=>{const{width:t,height:i,resolution:u,x:d,y:h}=e,p=d+u*t,b=h-u*i;return r>=d&&r<=p&&s<=h&&s>=b&&(a=new c.a({xmin:d,ymin:b,xmax:p,ymax:h,spatialReference:n}),o=t,l=i,!0)});const u=a.width/o,d=Math.round((r-a.xmin)/u),h=Math.round((a.ymax-s)/u);return{extent:a,width:o,height:l,x:d,y:h}}async doRefresh(){this.requestUpdate()}isUpdating(){return this.strategy.updating||this.updateRequested}fetchImage(e,t,i,r){return this.layer.fetchImage(e,t,i,{timeExtent:this._exportWMSImageParameters.timeExtent,timestamp:this.refreshTimestamp,...r})}};Object(r.a)([Object(n.b)()],g.prototype,"strategy",void 0),Object(r.a)([Object(n.b)({dependsOn:["strategy.updating"]})],g.prototype,"updating",void 0),g=Object(r.a)([Object(a.a)("esri.views.2d.layers.WMSLayerView2D")],g);var O=g;t.default=O},403:function(e,t,i){"use strict";i.d(t,"a",(function(){return a}));var r=i(5),s=(i(82),i(70)),n=i(50);i(414),i(55),i(66),i(85),i(111);r.a.getLogger("esri.renderers.support.utils");const a={inches:Object(n.a)(1,"meters","inches"),feet:Object(n.a)(1,"meters","feet"),"us-feet":Object(n.a)(1,"meters","us-feet"),yards:Object(n.a)(1,"meters","yards"),miles:Object(n.a)(1,"meters","miles"),"nautical-miles":Object(n.a)(1,"meters","nautical-miles"),millimeters:Object(n.a)(1,"meters","millimeters"),centimeters:Object(n.a)(1,"meters","centimeters"),decimeters:Object(n.a)(1,"meters","decimeters"),meters:Object(n.a)(1,"meters","meters"),kilometers:Object(n.a)(1,"meters","kilometers"),"decimal-degrees":1/Object(n.h)(1,"meters")};Object(s.a)("short-date")},412:function(e,t,i){"use strict";i.d(t,"a",(function(){return g})),i.d(t,"b",(function(){return b})),i.d(t,"c",(function(){return d})),i.d(t,"d",(function(){return p})),i.d(t,"e",(function(){return y})),i.d(t,"f",(function(){return f})),i.d(t,"g",(function(){return u})),i.d(t,"h",(function(){return m})),i.d(t,"i",(function(){return c})),i.d(t,"j",(function(){return h}));var r=i(44),s=i(75),n=i(299),a=i(166),o=i(212),l=i(447);const c={type:Boolean,value:!0,json:{origins:{"web-scene":{read:{source:["id","url","layerType"],reader(e,t){if(null!=t.screenSizePerspective||"defaults"!==this.originOf("screenSizePerspectiveEnabled"))return t.screenSizePerspective;Object(r.a)(this).store.set("screenSizePerspectiveEnabled",!1,0)}},write:{ignoreOrigin:!0,target:"screenSizePerspective",writer(e,t,i,r){("defaults"===this.originOf("screenSizePerspectiveEnabled")&&e||Object(n.a)(this,"screenSizePerspectiveEnabled",{},r))&&(t[i]=e)}}}}}},u={type:Boolean,value:!0,json:{name:"disablePopup",read:{reader:(e,t)=>!t.disablePopup},write:{enabled:!0,writer(e,t,i){t[i]=!e}}}},d={type:Boolean,value:!0,json:{name:"showLabels",write:!0}},h={type:String,json:{origins:{"portal-item":{write:!1}},write:{isRequired:!0,ignoreOrigin:!0,writer:s.f}}},p={type:Boolean,value:!0,json:{origins:{service:{read:{enabled:!1}}},name:"showLegend",write:!0}},b={value:null,type:l.a,json:{origins:{service:{name:"elevationInfo",write:!0}},name:"layerDefinition.elevationInfo",write:!0}};function m(e){return{type:e,readOnly:!0,json:{origins:{service:{read:!0}},read:!1}}}const y={type:Number,json:{origins:{"web-document":{default:1,write:!0,read:!0},"portal-item":{write:!0}}}},f={...y,json:{...y.json,origins:{"web-document":{...y.json.origins["web-document"],write:{enabled:!0,target:{opacity:{type:Number},"layerDefinition.drawingInfo.transparency":{type:Number}}}}},read:{source:["layerDefinition.drawingInfo.transparency","drawingInfo.transparency"],reader:(e,t,i)=>i&&"service"!==i.origin||!t.drawingInfo||void 0===t.drawingInfo.transparency?t.layerDefinition&&t.layerDefinition.drawingInfo&&void 0!==t.layerDefinition.drawingInfo.transparency?Object(a.b)(t.layerDefinition.drawingInfo.transparency):void 0:Object(a.b)(t.drawingInfo.transparency)}}},g={type:o.a,dependsOn:["view.timeExtent","layer.timeExtent","layer.timeInfo","layer.timeOffset","layer.timeOffset.value","layer.timeOffset.unit","layer.useViewTime"],readOnly:!0,get(){var e,t;if(!(null==(e=this.layer)?void 0:e.timeInfo))return null;const i=null==(t=this.view)?void 0:t.timeExtent,r=this.layer.timeExtent,s=this.layer.useViewTime?i&&r?i.intersection(r):i||r:r;if(!s||s.isEmpty)return s;const n=this.layer.timeOffset,a=n?s.offset(-n.value,n.unit):s,o=this._get("timeExtent");return a.equals(o)?o:a}}},414:function(e,t,i){"use strict";var r,s=i(0),n=(i(4),i(9),i(5),i(6)),a=i(1),o=i(2),l=i(22),c=(i(3),i(10),i(11),i(15)),u=i(35);let d=r=class extends c.a{constructor(e){super(e),this.color=null,this.label=null,this.value=null}writeValue(e,t,i){t[i]=null==e?0:e}clone(){return new r({color:this.color&&this.color.clone(),label:this.label,value:this.value})}};Object(s.a)([Object(a.b)({type:u.a,json:{type:[n.a],write:!0}})],d.prototype,"color",void 0),Object(s.a)([Object(a.b)({type:String,json:{write:!0}})],d.prototype,"label",void 0),Object(s.a)([Object(a.b)({type:Number,json:{write:{allowNull:!0}}})],d.prototype,"value",void 0),Object(s.a)([Object(l.a)("value")],d.prototype,"writeValue",null),d=r=Object(s.a)([Object(o.a)("esri.renderers.visualVariables.support.ColorStop")],d);var h=d;t.a=h},445:function(e,t,i){"use strict";var r=i(0),s=(i(4),i(9),i(5)),n=(i(6),i(1)),a=i(2),o=(i(3),i(10),i(11),i(18)),l=i(83),c=i(217),u=i(133),d=i(112);let h=class extends(Object(d.b)(Object(c.a)(Object(u.b)(l.a.EventedMixin(o.a))))){constructor(e){super(e),this.layer=null,this.parent=null}initialize(){this.when().catch(e=>{if("layerview:create-error"!==e.name){const t=this.layer&&this.layer.id||"no id",i=this.layer&&this.layer.title||"no title";throw s.a.getLogger(this.declaredClass).error("#resolve()",`Failed to resolve layer view (layer title: '${i}', id: '${t}')`,e),e}})}get fullOpacity(){const e=e=>null==e?1:e;return e(this.get("layer.opacity"))*e(this.get("parent.fullOpacity"))}get suspended(){return!this.canResume()}get suspendInfo(){return this.getSuspendInfo()}get legendEnabled(){return!this.suspended&&!0===this.layer.legendEnabled}get updating(){return!!(this.updatingHandles&&this.updatingHandles.updating||this.isUpdating())}get visible(){return!0===this.get("layer.visible")}set visible(e){void 0!==e?this._override("visible",e):this._clearOverride("visible")}canResume(){return!this.get("parent.suspended")&&this.get("view.ready")&&this.get("layer.loaded")&&this.visible||!1}getSuspendInfo(){const e=this.parent&&this.parent.suspended?this.parent.suspendInfo:{};return this.view&&this.view.ready||(e.viewNotReady=!0),this.layer&&this.layer.loaded||(e.layerNotLoaded=!0),this.visible||(e.layerInvisible=!0),e}isUpdating(){return!1}};Object(r.a)([Object(n.b)({dependsOn:["layer.opacity","parent.fullOpacity"]})],h.prototype,"fullOpacity",null),Object(r.a)([Object(n.b)()],h.prototype,"layer",void 0),Object(r.a)([Object(n.b)()],h.prototype,"parent",void 0),Object(r.a)([Object(n.b)({readOnly:!0,dependsOn:["visible","layer.loaded","parent.suspended","view?.ready"]})],h.prototype,"suspended",null),Object(r.a)([Object(n.b)({readOnly:!0,dependsOn:["visible","layer.loaded","parent.suspended","view?.ready"]})],h.prototype,"suspendInfo",null),Object(r.a)([Object(n.b)({readOnly:!0,dependsOn:["suspended","layer.legendEnabled?"]})],h.prototype,"legendEnabled",null),Object(r.a)([Object(n.b)({type:Boolean,dependsOn:["updatingHandles.updating"],readOnly:!0})],h.prototype,"updating",null),Object(r.a)([Object(n.b)({dependsOn:["layer.visible"]})],h.prototype,"visible",null),h=Object(r.a)([Object(a.a)("esri.views.layers.LayerView")],h);var p=h;t.a=p},446:function(e,t,i){"use strict";i.d(t,"a",(function(){return N}));var r=i(0),s=(i(4),i(9),i(5),i(6),i(1)),n=i(2),a=(i(3),i(10),i(11),i(21)),o=i(88),l=i(16),c=i(15);let u=class extends c.a{};u=Object(r.a)([Object(n.a)("esri.views.layers.support.ClipArea")],u);var d,h=u;let p=d=class extends h{constructor(){super(...arguments),this.type="rect",this.left=null,this.right=null,this.top=null,this.bottom=null}clone(){return new d({left:this.left,right:this.right,top:this.top,bottom:this.bottom})}get version(){return(this._get("version")||0)+1}};Object(r.a)([Object(s.b)({type:[Number,String],json:{write:!0}})],p.prototype,"left",void 0),Object(r.a)([Object(s.b)({type:[Number,String],json:{write:!0}})],p.prototype,"right",void 0),Object(r.a)([Object(s.b)({type:[Number,String],json:{write:!0}})],p.prototype,"top",void 0),Object(r.a)([Object(s.b)({type:[Number,String],json:{write:!0}})],p.prototype,"bottom",void 0),Object(r.a)([Object(s.b)({readOnly:!0,dependsOn:["left","right","top","bottom"]})],p.prototype,"version",null),p=d=Object(r.a)([Object(n.a)("esri.views.layers.support.ClipRect")],p);var b,m=p,y=i(496),f=i(71),g=i(36),O=i(95),x=i(59);i(54);const v={base:f.a,key:"type",typeMap:{extent:g.a,polygon:O.a}};let j=b=class extends h{constructor(){super(...arguments),this.type="geometry",this.geometry=null}get version(){return(this._get("version")||0)+1}clone(){return new b({geometry:this.geometry.clone()})}};Object(r.a)([Object(s.b)({types:v,json:{read:x.a,write:!0}})],j.prototype,"geometry",void 0),Object(r.a)([Object(s.b)({readOnly:!0,dependsOn:["geometry"]})],j.prototype,"version",null),j=b=Object(r.a)([Object(n.a)("esri.views.layers.support.Geometry")],j);var w=j;let _=class extends h{constructor(){super(...arguments),this.type="path",this.path=[]}get version(){return(this._get("version")||0)+1}};Object(r.a)([Object(s.b)({type:[[[Number]]],json:{write:!0}})],_.prototype,"path",void 0),Object(r.a)([Object(s.b)({readOnly:!0,dependsOn:["path"]})],_.prototype,"version",null),_=Object(r.a)([Object(n.a)("esri.views.layers.support.Path")],_);var S=_;const E=a.a.ofType({key:"type",base:h,typeMap:{rect:m,path:S,geometry:w}}),N=e=>{let t=class extends e{constructor(){super(...arguments),this.clips=new E,this.moving=!1,this.attached=!1,this.lastUpdateId=-1,this.updateRequested=!1}initialize(){var e;this.container||(this.container=new y.a),this.container.fadeTransitionEnabled=!0,this.container.opacity=0,this.container.clips=this.clips,this.handles.add([Object(l.a)(this,"suspended",e=>{this.container&&(this.container.visible=!e),this.view&&!e&&this.updateRequested&&this.view.requestUpdate()},!0),Object(l.a)(this,["layer.opacity","container"],()=>{var e,t;this.container&&(this.container.opacity=null!=(e=null==(t=this.layer)?void 0:t.opacity)?e:1)},!0),Object(l.a)(this,["layer.blendMode"],e=>{this.container&&(this.container.blendMode=e)},!0),Object(l.a)(this,["layer.effect"],e=>{this.container&&(this.container.effect=e)},!0),this.clips.on("change",()=>{this.container.clips=this.clips,this.notifyChange("clips")})]),(null==(e=this.view)?void 0:e.whenLayerView)?this.view.whenLayerView(this.layer).then(e=>{e!==this||this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{}):this.when().then(()=>{this.attached||this.destroyed||(this.attach(),this.requestUpdate(),this.attached=!0)},()=>{})}destroy(){this.attached&&(this.detach(),this.attached=!1),this.handles.remove("initialize"),this.updateRequested=!1}get updating(){return!this.attached||!this.suspended&&(this.updateRequested||this.isUpdating())}isVisibleAtScale(e){let t=!0;const i=this.layer,r=i.minScale,s=i.maxScale;if(null!=r&&null!=s){let i=!r,n=!s;!i&&e<=r&&(i=!0),!n&&e>=s&&(n=!0),t=i&&n}return t}requestUpdate(){this.updateRequested||(this.updateRequested=!0,this.suspended||this.view.requestUpdate())}processUpdate(e){!this.isFulfilled()||this.isResolved()?(this._set("updateParameters",e),this.updateRequested&&!this.suspended&&(this.updateRequested=!1,this.update(e))):this.updateRequested=!1}isUpdating(){return!1}isRendering(){return!1}canResume(){return!!super.canResume()&&this.isVisibleAtScale(this.view.scale)}};return Object(r.a)([Object(s.b)({type:E,set(e){const t=Object(o.b)(e,this._get("clips"),E);this._set("clips",t)}})],t.prototype,"clips",void 0),Object(r.a)([Object(s.b)()],t.prototype,"moving",void 0),Object(r.a)([Object(s.b)()],t.prototype,"attached",void 0),Object(r.a)([Object(s.b)()],t.prototype,"container",void 0),Object(r.a)([Object(s.b)({dependsOn:["view.scale","layer.minScale","layer.maxScale"]})],t.prototype,"suspended",void 0),Object(r.a)([Object(s.b)({readOnly:!0})],t.prototype,"updateParameters",void 0),Object(r.a)([Object(s.b)()],t.prototype,"updateRequested",void 0),Object(r.a)([Object(s.b)({dependsOn:["attached","updateRequested","suspended"]})],t.prototype,"updating",null),Object(r.a)([Object(s.b)()],t.prototype,"view",void 0),t=Object(r.a)([Object(n.a)("esri.views.2d.layers.LayerView2D")],t),t}},447:function(e,t,i){"use strict";var r,s=i(0),n=(i(4),i(9),i(8)),a=(i(5),i(6),i(1)),o=i(32),l=i(33),c=i(2),u=i(22),d=(i(3),i(10),i(11),i(15)),h=i(144);let p=r=class extends d.a{async collectRequiredFields(e,t){return Object(h.a)(e,t,this.expression)}clone(){return new r({expression:this.expression,title:this.title})}};Object(s.a)([Object(a.b)({type:String,json:{write:!0}})],p.prototype,"expression",void 0),Object(s.a)([Object(a.b)({type:String,json:{write:!0}})],p.prototype,"title",void 0),p=r=Object(s.a)([Object(c.a)("esri.layers.support.FeatureExpressionInfo")],p);var b=p,m=i(403);const y=function(){const e=Object.keys(m.a);return e.sort(),e}();var f;const g=Object(o.b)()({onTheGround:"on-the-ground",relativeToGround:"relative-to-ground",relativeToScene:"relative-to-scene",absoluteHeight:"absolute-height"}),O=new o.a({foot:"feet",kilometer:"kilometers",meter:"meters",mile:"miles","us-foot":"us-feet",yard:"yards"});let x=f=class extends d.a{constructor(){super(...arguments),this.offset=null}readFeatureExpressionInfo(e,t){return null!=e?e:t.featureExpression&&0===t.featureExpression.value?{expression:"0"}:void 0}writeFeatureExpressionInfo(e,t,i,r){t[i]=e.write(null,r),"0"===e.expression&&(t.featureExpression={value:0})}get mode(){return this._isOverridden("mode")?this._get("mode"):Object(n.h)(this.offset)||this.featureExpressionInfo?"relative-to-ground":"on-the-ground"}set mode(e){this._override("mode",e)}set unit(e){this._set("unit",e)}write(e,t){return this.offset||this.mode||this.featureExpressionInfo||this.unit?super.write(e,t):null}clone(){return new f({mode:this.mode,offset:this.offset,featureExpressionInfo:this.featureExpressionInfo?this.featureExpressionInfo.clone():void 0,unit:this.unit})}};Object(s.a)([Object(a.b)({type:b,json:{write:!0}})],x.prototype,"featureExpressionInfo",void 0),Object(s.a)([Object(l.a)("featureExpressionInfo",["featureExpressionInfo","featureExpression"])],x.prototype,"readFeatureExpressionInfo",null),Object(s.a)([Object(u.a)("featureExpressionInfo",{featureExpressionInfo:{type:b},"featureExpression.value":{type:[0]}})],x.prototype,"writeFeatureExpressionInfo",null),Object(s.a)([Object(a.b)({type:g.apiValues,dependsOn:["offset","featureExpressionInfo"],nonNullable:!0,json:{type:g.jsonValues,read:g.read,write:{writer:g.write,isRequired:!0}}})],x.prototype,"mode",null),Object(s.a)([Object(a.b)({type:Number,json:{write:!0}})],x.prototype,"offset",void 0),Object(s.a)([Object(a.b)({type:y,json:{type:String,read:O.read,write:O.write}})],x.prototype,"unit",null),x=f=Object(s.a)([Object(c.a)("esri.layers.support.ElevationInfo")],x);var v=x;t.a=v},548:function(e,t,i){"use strict";t.a=class{constructor(e,t,i){this.pixelBlock=e,this.extent=t,this.originalPixelBlock=i}get width(){return this.pixelBlock?this.pixelBlock.width:0}get height(){return this.pixelBlock?this.pixelBlock.height:0}render(e){const t=this.pixelBlock;if(!t)return;const i=this.filter({pixelBlock:t}),r=i.pixelBlock.getAsRGBA(),s=e.createImageData(i.pixelBlock.width,i.pixelBlock.height);s.data.set(r),e.putImageData(s,0,0)}getRenderedRasterPixels(){const e=this.filter({pixelBlock:this.pixelBlock});return{width:e.pixelBlock.width,height:e.pixelBlock.height,renderedRasterPixels:new Uint8Array(e.pixelBlock.getAsRGBA().buffer)}}}},552:function(e,t,i){"use strict";i.d(t,"a",(function(){return u}));var r=i(148),s=i(216),n=i(260),a=(i(404),i(405),i(406)),o=(i(407),i(408),i(409),i(411),i(451)),l=i(548);function c(e,t,i){const r={target:3553,pixelFormat:6408,internalFormat:6408,dataType:5121,wrapMode:33071};return t&&i&&(r.width=t,r.height=i),new a.a(e,r)}class u extends o.a{constructor(e=null,t=!0){super(),this.requestRenderOnSourceChangedEnabled=t,this._textureInvalidated=!0,this.stencilRef=0,this.coordScale=[1,1],this._height=void 0,this.pixelRatio=1,this.resolution=0,this.rotation=0,this._source=null,this._width=void 0,this.x=0,this.y=0,this.transforms={dvs:Object(s.b)()},this.source=e,this.requestRender=this.requestRender.bind(this)}get isSourceScaled(){return this.width!==this.sourceWidth||this.height!==this.sourceHeight}get height(){return void 0!==this._height?this._height:this.sourceHeight}set height(e){this._height=e}get source(){return this._source}set source(e){this._source=e,this.invalidateTexture()}get sourceHeight(){return this._source instanceof HTMLImageElement?this._source.naturalHeight:this._source.height}get sourceWidth(){return this._source instanceof HTMLImageElement?this._source.naturalWidth:this._source.width}get width(){return void 0!==this._width?this._width:this.sourceWidth}set width(e){this._width=e}invalidateTexture(){this._textureInvalidated||(this._textureInvalidated=!0,this.requestRenderOnSourceChangedEnabled&&this.requestRender())}setTransform(e){const t=Object(r.e)(this.transforms.dvs),[i,s]=e.toScreenNoRotation([0,0],this.x,this.y),a=this.resolution/this.pixelRatio/e.resolution,o=a*this.width,l=a*this.height,c=Math.PI*this.rotation/180;Object(r.a)(t,t,Object(n.b)(i,s)),Object(r.a)(t,t,Object(n.b)(o/2,l/2)),Object(r.i)(t,t,-c),Object(r.a)(t,t,Object(n.b)(-o/2,-l/2)),Object(r.f)(t,t,Object(n.b)(o,l)),Object(r.g)(this.transforms.dvs,e.displayViewMat3,t)}setSamplingProfile(e){this._texture&&(e.mips&&!this._texture.descriptor.hasMipmap&&this._texture.generateMipmap(),this._texture.setSamplingMode(e.samplingMode))}bind({context:e},t){this._texture&&e.bindTexture(this._texture,t)}updateTexture({context:e}){var t;if(!this.stage)return null==(t=this._texture)||t.dispose(),void(this._texture=null);if(!this._textureInvalidated)return;this._textureInvalidated=!1,this._texture||(this.source?this._texture=c(e,this.sourceWidth,this.sourceHeight):this._texture=c(e));const i=this.source;if(i){if(this._texture.resize(this.sourceWidth,this.sourceHeight),function(e){return e&&"render"in e}(i))if(i instanceof l.a){const e=i.getRenderedRasterPixels();this._texture.setData(e.renderedRasterPixels)}else this._texture.setData(function(e){const t=document.createElement("canvas");return t.width=e.width,t.height=e.height,e.render(t.getContext("2d")),t}(i));else(function(e){return e&&!("render"in e)})(i)&&this._texture.setData(i);this.ready()}else this._texture.setData(null)}onAttach(){this.invalidateTexture()}onDetach(){this.invalidateTexture()}}},576:function(e,t,i){"use strict";i.d(t,"a",(function(){return n}));var r=i(549),s=i(524);class n extends s.a{prepareRenderPasses(e){const t=e.registerRenderPass({name:"bitmap",brushes:[r.a.bitmap],target:()=>this.children});return[...super.prepareRenderPasses(e),t]}}},598:function(e,t,i){"use strict";var r=i(0),s=(i(4),i(9),i(5),i(6),i(1)),n=i(2),a=(i(3),i(10),i(7)),o=(i(11),i(18)),l=i(34),c=i(36),u=i(259),d=i(304),h=i(147),p=i(311);const b=Math.PI/180;var m=i(552);const y=Object(u.d)(),f=[0,0],g=new h.a(0,0,0,0);let O=class extends o.a{constructor(e){super(e),this._imagePromise=null,this.hidpi=!1,this.imageMaxWidth=2048,this.imageMaxHeight=2048,this.imageRotationSupported=!1,this.imageNormalizationSupported=!1,this.update=Object(a.n)(async(e,t)=>{const i=e.state,r=Object(l.d)(i.spatialReference),s=this.hidpi?e.pixelRatio:1;if(!e.stationary||this.destroyed)return;this.imageRotationSupported?(f[0]=i.size[0],f[1]=i.size[1]):function(e,t){const i=t.rotation*b,r=Math.abs(Math.cos(i)),s=Math.abs(Math.sin(i)),[n,a]=t.size;e[0]=Math.round(a*s+n*r),e[1]=Math.round(a*r+n*s)}(f,i);const n=Math.floor(f[0]*s)>this.imageMaxWidth||Math.floor(f[1]*s)>this.imageMaxHeight,a=r&&(i.extent.xmin<r.valid[0]||i.extent.xmax>r.valid[1]),o=!this.imageNormalizationSupported&&a,c=!n&&!o,u=this.imageRotationSupported?i.rotation:0;if(c)this._imagePromise=this._singleExport(i,f,u,s,t);else{let e=Math.min(this.imageMaxWidth,this.imageMaxHeight);o&&(e=Math.min(i.worldScreenWidth,e)),this._imagePromise=this._tiledExport(i,e,u,s,t)}return this._imagePromise.then(e=>{this._imagePromise=null;const t=this.container.children.slice();this.container.removeAllChildren(),e.forEach(this.container.addChild,this.container),this.disposeSource&&t.forEach(e=>{this.disposeSource(e.source)},this)}).catch(e=>{throw this._imagePromise=null,e})},5e3)}destroy(){}get updating(){return null!==this._imagePromise}updateExports(e){for(const t of this.container.children){if(!t.visible||!t.stage)return;e(t)?console.error("ExportStrategy.updateExports doesn't support promise yet"):(t.invalidateTexture(),t.requestRender())}}_export(e,t,i,r,s,n){return Object(a.r)().then(()=>this.fetchSource(e,Math.floor(t*s),Math.floor(i*s),{rotation:r,pixelRatio:s,signal:n})).then(i=>{const n=new m.a(i);return n.x=e.xmin,n.y=e.ymax,n.resolution=e.width/t,n.rotation=r,n.pixelRatio=s,n})}_singleExport(e,t,i,r,s){!function(e,t,i,r){const[s,n]=t,[a,o]=r,l=.5*i;e[0]=s-l*a,e[1]=n-l*o,e[2]=s+l*a,e[3]=n+l*o}(y,e.center,e.resolution,t);const n=new c.a(y[0],y[1],y[2],y[3],e.spatialReference);return this._export(n,t[0],t[1],i,r,s).then(e=>[e])}_tiledExport(e,t,i,r,s){const n=d.a.create({size:t,spatialReference:e.spatialReference,scales:[e.scale]}),o=new p.a(n),l=o.getTileCoverage(e);if(!l)return null;const u=[];return l.forEach((n,a,l,d)=>{g.set(n,a,l,d),o.getTileBounds(y,g);const h=new c.a(y[0],y[1],y[2],y[3],e.spatialReference);u.push(this._export(h,t,t,i,r,s))}),Object(a.a)(u)}};Object(r.a)([Object(s.b)()],O.prototype,"_imagePromise",void 0),Object(r.a)([Object(s.b)()],O.prototype,"container",void 0),Object(r.a)([Object(s.b)()],O.prototype,"disposeSource",void 0),Object(r.a)([Object(s.b)()],O.prototype,"fetchSource",void 0),Object(r.a)([Object(s.b)()],O.prototype,"hidpi",void 0),Object(r.a)([Object(s.b)()],O.prototype,"imageMaxWidth",void 0),Object(r.a)([Object(s.b)()],O.prototype,"imageMaxHeight",void 0),Object(r.a)([Object(s.b)()],O.prototype,"imageRotationSupported",void 0),Object(r.a)([Object(s.b)()],O.prototype,"imageNormalizationSupported",void 0),Object(r.a)([Object(s.b)()],O.prototype,"requestUpdate",void 0),Object(r.a)([Object(s.b)({dependsOn:["_imagePromise"]})],O.prototype,"updating",null),O=Object(r.a)([Object(n.a)("esri.views.2d.layers.support.ExportStrategy")],O);var x=O;t.a=x},662:function(e,t,i){"use strict";i.d(t,"a",(function(){return u})),i.d(t,"b",(function(){return d})),i.d(t,"c",(function(){return c})),i.d(t,"d",(function(){return I}));var r=i(14),s=i(3),n=i(28),a=i(36);const o=[[4001,4999],[2044,2045],[2081,2083],[2085,2086],[2093,2093],[2096,2098],[2105,2132],[2169,2170],[2176,2180],[2193,2193],[2200,2200],[2206,2212],[2319,2319],[2320,2462],[2523,2549],[2551,2735],[2738,2758],[2935,2941],[2953,2953],[3006,3030],[3034,3035],[3058,3059],[3068,3068],[3114,3118],[3126,3138],[3300,3301],[3328,3335],[3346,3346],[3350,3352],[3366,3366],[3416,3416],[20004,20032],[20064,20092],[21413,21423],[21473,21483],[21896,21899],[22171,22177],[22181,22187],[22191,22197],[25884,25884],[27205,27232],[27391,27398],[27492,27492],[28402,28432],[28462,28492],[30161,30179],[30800,30800],[31251,31259],[31275,31279],[31281,31290],[31466,31700]],l={84:4326,83:4269,27:4267};function c(e){if(!e)return null;const t={idCounter:-1};"string"==typeof e&&(e=(new DOMParser).parseFromString(e,"text/xml"));const i=e.documentElement;if("ServiceExceptionReport"===i.nodeName){const e=Array.prototype.slice.call(i.childNodes).map(e=>e.textContent).join("\r\n");throw new r.a("wmslayer:wms-capabilities-xml-is-not-valid","The server returned errors when the WMS capabilities were requested.",e)}const s=p("Capability",i),n=p("Service",i),o=p("Request",s);if(!s||!n||!o)return null;const l=p("Layer",s);if(!l)return null;const c="WMS_Capabilities"===i.nodeName||"WMT_MS_Capabilities"===i.nodeName?i.getAttribute("version"):"1.3.0",u=m("Title",n,"")||m("Name",n,""),d=m("AccessConstraints",n,""),h=m("Abstract",n,""),b=parseInt(m("MaxWidth",n,"5000"),10),y=parseInt(m("MaxHeight",n,"5000"),10),O=g(o,"GetMap"),v=f(o,"GetMap"),w=x(l,c,t);let _,S,E,N,I=0;if(Array.prototype.slice.call(s.childNodes).forEach(e=>{"Layer"===e.nodeName&&(0===I?_=e:1===I?(w.name&&(w.name="",w.sublayers.push(x(_,c,t))),w.sublayers.push(x(e,c,t))):w.sublayers.push(x(e,c,t)),I++)}),!w)return null;const R=w.fullExtents;if(S=w.sublayers,S||(S=[]),0===S.length&&S.push(w),E=w.extent,!E){const e=new a.a(S[0].extent);w.extent=e.toJSON(),E=w.extent}if(N=w.spatialReferences,!N.length&&S.length>0){const e=t=>{let i=[];return t.sublayers.forEach(t=>{!i.length&&t.spatialReferences.length&&(i=t.spatialReferences||e(t))}),i};S.forEach(t=>{N.length||(N=t.spatialReferences||e(t))})}const M=f(o,"GetFeatureInfo");let P;if(M){const e=g(o,"GetFeatureInfo");e.indexOf("text/html")>-1?P="text/html":e.indexOf("text/plain")>-1&&(P="text/plain")}if(!P){const e=function(t){t&&(t.queryable=!1,t.sublayers&&t.sublayers.forEach(t=>{e(t)}))};e(w)}const A=function e(t){let i=[];return t.forEach(t=>{i.push(t),t.sublayers&&t.sublayers.length&&(i=i.concat(e(t.sublayers)),delete t.sublayers)}),i}(S),T=w.minScale||0,q=w.maxScale||0,C=w.dimensions,F=A.reduce((e,t)=>e.concat(t.dimensions),[]),L=C.concat(F).filter(j);let k=null;if(L.length>0){let e=Number.POSITIVE_INFINITY,t=Number.NEGATIVE_INFINITY;L.forEach(i=>{const{extent:r}=i;var s;s=r,Array.isArray(s)&&s.length>0&&s[0]instanceof Date?r.forEach(i=>{e=Math.min(e,i.getTime()),t=Math.max(t,i.getTime())}):r.forEach(i=>{e=Math.min(e,i.min.getTime()),t=Math.max(t,i.max.getTime())})}),k={startTimeField:null,endTimeField:null,trackIdField:null,timeExtent:[e,t]}}return{copyright:d,description:h,dimensions:C,extent:E,fullExtents:R,featureInfoFormat:P,featureInfoUrl:M,mapUrl:v,maxImageWidth:b,maxImageHeight:y,maxScale:q,minScale:T,layers:A,spatialReferences:N,supportedImageFormatTypes:O,timeInfo:k,title:u,version:c}}function u(e){return o.some(t=>{const i=t[0],r=t[1];return e>=i&&e<=r})}function d(e){return e.length?e.filter(e=>e.popupEnabled&&e.name&&e.queryable).map(e=>e.name).join(","):""}function h(e,t,i){var r;return null!=(r=t.getAttribute(e))?r:i}function p(e,t){for(let i=0;i<t.childNodes.length;i++){const r=t.childNodes[i];if(v(r)&&r.nodeName===e)return r}return null}function b(e,t){const i=[];for(let r=0;r<t.childNodes.length;r++){const s=t.childNodes[r];v(s)&&s.nodeName===e&&i.push(s)}return i}function m(e,t,i){const r=p(e,t);return r?r.textContent:i}function y(e,t,i){if(!e)return null;const r=parseFloat(e.getAttribute("minx")),s=parseFloat(e.getAttribute("miny")),o=parseFloat(e.getAttribute("maxx")),l=parseFloat(e.getAttribute("maxy"));let c,u,d,h;i?(c=isNaN(s)?-Number.MAX_VALUE:s,u=isNaN(r)?-Number.MAX_VALUE:r,d=isNaN(l)?Number.MAX_VALUE:l,h=isNaN(o)?Number.MAX_VALUE:o):(c=isNaN(r)?-Number.MAX_VALUE:r,u=isNaN(s)?-Number.MAX_VALUE:s,d=isNaN(o)?Number.MAX_VALUE:o,h=isNaN(l)?Number.MAX_VALUE:l);const p=new n.a({wkid:t});return new a.a({xmin:c,ymin:u,xmax:d,ymax:h,spatialReference:p})}function f(e,t){const i=p(t,e);if(i){const e=p("DCPType",i);if(e){const t=p("HTTP",e);if(t){const e=p("Get",t);if(e){let t=function(e,t,i,r){const s=p("OnlineResource",i);return s?h("xlink:href",s,null):null}(0,0,e);if(t)return t.indexOf("&")===t.length-1&&(t=t.substring(0,t.length-1)),function(e,t){const i=[],r=Object(s.H)(e);for(const e in r.query)r.query.hasOwnProperty(e)&&-1===t.indexOf(e.toLowerCase())&&i.push(e+"="+r.query[e]);return r.path+(i.length?"?"+i.join("&"):"")}(t,["service","request"])}}}}return null}function g(e,t){const i=b("Operation",e);if(0===i.length)return b("Format",p(t,e)).map(e=>e.textContent);const r=[];return i.forEach(e=>{e.getAttribute("name")===t&&b("Format",e).forEach(e=>{r.push(e.textContent)})}),r}function O(e,t,i){const r=p(t,e);if(!r)return i;const{textContent:s}=r;if(null==s||""===s)return i;const n=Number(s);return isNaN(n)?i:n}function x(e,t,i){var r;if(!e)return null;const s={id:i.idCounter++,fullExtents:[],parentLayerId:null,queryable:"1"===e.getAttribute("queryable"),spatialReferences:[],sublayers:null},o=p("LatLonBoundingBox",e),c=p("EX_GeographicBoundingBox",e);let d=null;o&&(d=y(o,4326)),c&&(d=new a.a(0,0,0,0,new n.a({wkid:4326})),d.xmin=parseFloat(m("westBoundLongitude",c,"0")),d.ymin=parseFloat(m("southBoundLatitude",c,"0")),d.xmax=parseFloat(m("eastBoundLongitude",c,"0")),d.ymax=parseFloat(m("northBoundLatitude",c,"0"))),o||c||(d=new a.a(-180,-90,180,90,new n.a({wkid:4326}))),s.minScale=O(e,"MaxScaleDenominator",0),s.maxScale=O(e,"MinScaleDenominator",0);const f=["1.0.0","1.1.0","1.1.1"].indexOf(t)>-1?"SRS":"CRS";return Array.prototype.slice.call(e.childNodes).forEach(e=>{if("Name"===e.nodeName)s.name=e.textContent||"";else if("Title"===e.nodeName)s.title=e.textContent||"";else if("Abstract"===e.nodeName)s.description=e.textContent||"";else if("BoundingBox"===e.nodeName){const i=e.getAttribute(f);if(i&&0===i.indexOf("EPSG:")){const r=parseInt(i.substring(5),10);0===r||isNaN(r)||d||(d="1.3.0"===t?y(e,r,u(r)):y(e,r))}const r=i&&i.indexOf(":");if(r&&r>-1){let n=parseInt(i.substring(r+1,i.length),10);0===n||isNaN(n)||(n=l[n]?l[n]:n);const a="1.3.0"===t?y(e,n,u(n)):y(e,n);s.fullExtents.push(a)}}else if(e.nodeName===f)e.textContent.split(" ").forEach(e=>{0===(e=e.indexOf(":")>-1?parseInt(e.split(":")[1],10):parseInt(e,10))||isNaN(e)||(l[e]&&(e=l[e]),-1===s.spatialReferences.indexOf(e)&&s.spatialReferences.push(e))});else if("Style"!==e.nodeName||s.legendURL){if("Layer"===e.nodeName){const r=x(e,t,i);r&&(r.parentLayerId=s.id,s.sublayers||(s.sublayers=[]),s.sublayers.push(r))}}else{const t=p("LegendURL",e);if(t){const e=p("OnlineResource",t);e&&(s.legendURL=e.getAttribute("xlink:href"))}}}),s.extent=null==(r=d)?void 0:r.toJSON(),s.dimensions=b("Dimension",e).filter(e=>e.getAttribute("name")&&e.getAttribute("units")&&e.textContent).map(e=>{const t=e.getAttribute("name"),i=e.getAttribute("units"),r=e.textContent,s=e.getAttribute("unitSymbol"),n=e.getAttribute("default"),a="0"!==h("default",e,"0"),o="0"!==h("nearestValue",e,"0"),l="0"!==h("current",e,"0");return/^time$/i.test(t)&&/^ISO8601$/i.test(i)?{name:"time",units:"ISO8601",extent:S(r),default:S(n),multipleValues:a,nearestValue:o,current:l}:/^elevation$/i.test(t)?{name:"elevation",units:i,extent:w(r),unitSymbol:s,default:w(n),multipleValues:a,nearestValue:o}:{name:t,units:i,extent:_(r),unitSymbol:s,default:_(n),multipleValues:a,nearestValue:o}}),s}function v(e){return e.nodeType===Node.ELEMENT_NODE}function j(e){return"time"===e.name}function w(e){if(!e)return null;const t=-1!==e.indexOf("/"),i=e.split(",");return t?i.map(e=>{const t=e.split("/");return t.length<2?null:{min:parseFloat(t[0]),max:parseFloat(t[1]),resolution:t.length>=3&&"0"!==t[2]?parseFloat(t[2]):void 0}}).filter(e=>e):i.map(e=>parseFloat(e))}function _(e){if(!e)return null;const t=-1!==e.indexOf("/"),i=e.split(",");return t?i.map(e=>{const t=e.split("/");return t.length<2?null:{min:t[0],max:t[1],resolution:t.length>=3&&"0"!==t[2]?t[2]:void 0}}).filter(e=>e):i}function S(e){if(!e)return null;const t=-1!==e.indexOf("/"),i=e.split(",");return t?i.map(e=>{const t=e.split("/");return t.length<2?null:{min:new Date(t[0]),max:new Date(t[1]),resolution:t.length>=3&&"0"!==t[2]?E(t[2]):void 0}}).filter(e=>e):i.map(e=>new Date(e))}function E(e){const t=e.match(/(?:p(\d+y|\d+(?:.|,)\d+y)?(\d+m|\d+(?:.|,)\d+m)?(\d+d|\d+(?:.|,)\d+d)?)?(?:t(\d+h|\d+(?:.|,)\d+h)?(\d+m|\d+(?:.|,)\d+m)?(\d+s|\d+(?:.|,)\d+s)?)?/i);return t?{years:N(t[1]),months:N(t[2]),days:N(t[3]),hours:N(t[4]),minutes:N(t[5]),seconds:N(t[6])}:null}function N(e){if(!e)return 0;const t=e.match(/(?:\d+(?:.|,)\d+|\d+)/);if(!t)return 0;const i=t[0].replace(",",".");return Number(i)}function I(e){return e.toISOString().replace(/\.[0-9]{3}/,"")}},725:function(e,t,i){"use strict";var r=i(0),s=(i(4),i(9),i(5),i(6),i(1)),n=i(2),a=(i(3),i(10),i(11),i(18)),o=i(43),l=i(412),c=i(662);const u={visible:"visibleSublayers"},d=[102100,3857,102113,900913],h=[3395,54004];let p=class extends a.a{constructor(){super(...arguments),this._layerHandles=new o.a,this.extent=null,this._scale=null,this.view=null}set layer(e){this._get("layer")!==e&&(this._set("layer",e),this._layerHandles&&(this._layerHandles.removeAll(),this._layerHandles=null),e&&(this._layerHandles||(this._layerHandles=new o.a),this._layerHandles.add([e.sublayers.on("change",()=>this.notifyChange("visibleSublayers")),e.on("wms-sublayer-update",e=>this.notifyChange(u[e.propertyName]))])))}get layers(){const{visibleSublayers:e}=this;return e.filter(e=>e.name).map(e=>e.name).join(",")}get scale(){return null!=this._scale?this._scale:this.view&&this.view.scale||0}set scale(e){this.view||(this._scale=e,this.notifyChange("scale"))}get version(){return(this._get("version")||0)+1}get visibleSublayers(){const{layer:e,scale:t}=this,{sublayers:i}=e,r=[],s=e=>{const{minScale:i,maxScale:n,sublayers:a,visible:o}=e;o&&(0===t||(0===i||t<=i)&&(0===n||t>=n))&&(a?a.forEach(s):r.unshift(e))};return null==i||i.forEach(s),r}get wkid(){const{extent:e,layer:t}=this,i=t.spatialReferences;let r=e.spatialReference&&e.spatialReference.wkid;i&&-1===i.indexOf(r)&&e.spatialReference.latestWkid&&(r=e.spatialReference.latestWkid);const s=d.some(e=>e===r);if(!i)return r;if(s){const e=[];i.forEach(t=>{d.indexOf(t)>-1&&e.push(t)}),e.length||i.forEach(t=>{h.indexOf(t)>-1&&e.push(t)}),r=e.length>0?e[0]:d[0]}return r}toJSON(){const{extent:e,layer:t,layers:i}=this,{imageFormat:r,imageTransparency:s,spatialReferences:n,version:a}=t;let{wkid:o}=this;n&&-1===n.indexOf(o)&&e.spatialReference.latestWkid&&(o=e.spatialReference.latestWkid);const{xmin:l,ymin:u,xmax:d,ymax:h}=e,p={bbox:"1.3.0"===t.version&&Object(c.a)(o)?`${u},${l},${h},${d}`:`${l},${u},${d},${h}`,format:r,request:"GetMap",service:"WMS",styles:"",transparent:s,version:a};return isNaN(o)||("1.3.0"===a?p.crs="EPSG:"+o:p.srs="EPSG:"+o),{...p,layers:i}}};Object(r.a)([Object(s.b)()],p.prototype,"extent",void 0),Object(r.a)([Object(s.b)()],p.prototype,"layer",null),Object(r.a)([Object(s.b)({readOnly:!0,dependsOn:["visibleSublayers"]})],p.prototype,"layers",null),Object(r.a)([Object(s.b)({type:Number,dependsOn:["view.scale"]})],p.prototype,"scale",null),Object(r.a)([Object(s.b)(l.a)],p.prototype,"timeExtent",void 0),Object(r.a)([Object(s.b)({type:Number,dependsOn:["layers","layer.imageTransparency","timeExtent"],readOnly:!0})],p.prototype,"version",null),Object(r.a)([Object(s.b)()],p.prototype,"view",void 0),Object(r.a)([Object(s.b)({readOnly:!0,dependsOn:["layer.sublayers","scale"]})],p.prototype,"visibleSublayers",null),Object(r.a)([Object(s.b)()],p.prototype,"wkid",null),p=Object(r.a)([Object(n.a)("esri.layers.support.ExportWMSImageParameters")],p);var b=p;t.a=b}}]);